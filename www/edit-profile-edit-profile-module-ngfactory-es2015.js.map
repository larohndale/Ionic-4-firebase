{"version":3,"sources":["./src/app/edit-profile/edit-profile.module.ts","./src/app/edit-profile/edit-profile.page.html","./src/app/edit-profile/edit-profile.page.ts"],"names":[],"mappings":"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","file":"edit-profile-edit-profile-module-ngfactory-es2015.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { EditProfilePage } from './edit-profile.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: EditProfilePage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [EditProfilePage]\n})\nexport class EditProfilePageModule {}\n","<ion-header no-border>\n  <ion-toolbar no-border>\n\n    <ion-title>Edit Profile</ion-title>\n    <ion-buttons slot=\"end\" padding>\n      <ion-button (click)=\"save(name, phone, about, username)\" slot=\"end\">Save</ion-button>\n    </ion-buttons>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content padding>\n  <div class=\"form\">\n\n    <div text-center>\n      <img *ngIf=\"img && !urlImage\" src=\"{{img}}\" class=\"circle\">\n      <img *ngIf=\"urlImage\" [src]=\"urlImage | async\" class=\"circle\">\n\n      <br>\n      <br>\n      <img *ngIf=\"!urlImage && !img\" src=\"assets/user.svg\" width=\"200px\"> <br>\n    </div>\n\n\n    <div margin-bottom margin-top text-center>\n      <label class=\"custom-file-upload\" style=\"margin:auto;max-width:400px\">\n        <input id=\"file-upload\" placeholder=\"Seleciona imagen\" type=\"file\" accept=\".png, .jpg\"\n          (change)=\"onUpload($event)\" />\n        <ion-icon margin-right name=\"cloud-download\"></ion-icon> Select profile photo\n      </label>\n    </div>                                                                                                                                                                                  \n    <br>\n    <h3 class=\"goodfont\">Profile info</h3>\n\n    <br>\n    <ion-item>\n      <ion-input [(ngModel)]=\"username\" (keyup.enter)=\"moveFocus(b)\" placeholder=\"username\"></ion-input>\n      <ion-icon name=\"at\" slot=\"start\"></ion-icon>\n    </ion-item>\n    <br>\n    <ion-item margin-bottom margin-bottom>\n      <ion-input (keyup.enter)=\"moveFocus(c)\" type=\"text\" #b placeholder=\"Name\" [(ngModel)]=\"name\"></ion-input>\n    </ion-item>\n    <ion-item margin-bottom margin-bottom>\n      <ion-input #c (keyup.enter)=\"moveFocus(d)\" type=\"text\" placeholder=\"Phone\" [(ngModel)]=\"phone\"></ion-input>\n    </ion-item>\n\n    <ion-item margin-bottom margin-bottom>\n      <ion-input [(ngModel)]=\"mail\" disabled></ion-input>\n    </ion-item>\n\n    <ion-item margin-bottom margin-bottom>\n      <ion-textarea #d (keyup.enter)=\"save(name, phone, about)\" type=\"text\" placeholder=\"About\" [(ngModel)]=\" about\">\n      </ion-textarea>\n    </ion-item>\n\n\n\n    <input #imageProd type=\"hidden\" [value]=\"urlImage | async\" style=\"color:black;\">\n    <br><br>\n    <!-- <ion-button mode=\"ios\" size=\"large\" class=\"main-container\" color=\"light\" expand=\"block\">\n    Save</ion-button> -->\n  </div>\n</ion-content>","import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { ServicesService } from '../services/services.service';\nimport { Observable } from 'rxjs';\nimport { LoadingController } from '@ionic/angular';\nimport { Router } from '@angular/router';\nimport { AngularFireStorage } from '@angular/fire/storage';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { finalize } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-edit-profile',\n  templateUrl: './edit-profile.page.html',\n  styleUrls: ['./edit-profile.page.scss'],\n})\nexport class EditProfilePage implements OnInit {\n  @ViewChild('imageProd', { static: true }) inputimageProd: ElementRef;\n  id: any;\n  uid: string;\n  name: any;\n  phone: string;\n  about: string;\n  img: any;\n  mail: string;\n  uploadPercent: Observable<number>;\n  urlImage: Observable<string>;\n  item: any;\n  username: string;\n\n  cp: Boolean;\n\n  constructor(private roouter: Router,\n    private services: ServicesService,\n    private afs: AngularFireStorage,\n    private loadingController: LoadingController,\n    private auth: AngularFireAuth) {\n  }\n\n  ngOnInit() {\n    this.getUser();\n  }\n\n\n  getUser() {\n    this.auth.authState\n      .subscribe(\n        user => {\n          if (user) {\n            this.mail = user.email;\n            this.uid = user.uid;\n            console.log(this.mail);\n            this.getProfile(this.uid);\n          }\n        });\n  }\n\n  async getProfile(id: string) {\n    this.services.getProfile(id).subscribe((data: any) => {\n      console.log(data);\n      if (data.length !== 0) {\n        console.log(data[0].payload.doc);\n        this.cp = true;\n        this.id = data[0].payload.doc.id;\n        this.name = data[0].payload.doc.data().name;\n        this.phone = data[0].payload.doc.data().phone;\n        this.about = data[0].payload.doc.data().about;\n        this.img = data[0].payload.doc.data().img;\n        this.username = data[0].payload.doc.data().username;\n        console.log('profile full');\n      } else {\n        this.cp = false;\n        console.log('profile empty');\n      }\n    });\n  }\n\n\n  onUpload(e: { target: { files: any[]; }; }) {\n    console.log(e.target.files[0]);\n\n    const id = Math.random().toString(36).substring(2);\n    const file = e.target.files[0];\n    const filePath = `image/pic_${id}`;\n    const ref = this.afs.ref(filePath);\n    const task = this.afs.upload(filePath, file);\n    this.uploadPercent = task.percentageChanges();\n    this.presentLoading();\n    task.snapshotChanges().pipe(finalize(() => this.urlImage = ref.getDownloadURL())).subscribe();\n  }\n\n\n  save(name: any, phone: any, about: any, username?: any) {\n    console.log(this.cp);\n    const image = this.inputimageProd.nativeElement.value;\n    const data = {\n      name: name,\n      phone: phone,\n      mail: this.mail,\n      img: image || this.img,\n      about: about,\n      uid: this.uid,\n      username: username || 'null'\n    };\n    console.log(data);\n    if (this.cp === false) {\n      this.services.createUser(data).then(\n        res => {\n          console.log('Upload' + res);\n          this.roouter.navigateByUrl(`/profile`);\n        });\n    } else {\n      this.services.updateUser(data, this.id).then(\n        res => {\n          console.log('Upload' + res);\n          this.roouter.navigateByUrl(`/profile`);\n        });\n    }\n\n  }\n\n\n  async presentLoading() {\n    const loading = await this.loadingController.create({\n      message: 'Loading image',\n      duration: 2000\n    });\n    await loading.present();\n\n    const { role, data } = await loading.onDidDismiss();\n\n    console.log('Loading dismissed!');\n  }\n  moveFocus(nextElement: { setFocus: () => void; }) {\n    nextElement.setFocus();\n  }\n\n}\n"],"sourceRoot":"webpack:///"}