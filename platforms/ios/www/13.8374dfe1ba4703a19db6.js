(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"8cDG":function(n,l,t){"use strict";t.r(l);var e=t("CcnG"),o=t("ZZ/e"),u=t("Pn9U"),i=t("6+PL"),r=t("iqUP"),a=t("wd/R"),c=function(n,l,t,e){return new(t||(t=Promise))(function(o,u){function i(n){try{a(e.next(n))}catch(l){u(l)}}function r(n){try{a(e.throw(n))}catch(l){u(l)}}function a(n){n.done?o(n.value):new t(function(l){l(n.value)}).then(i,r)}a((e=e.apply(n,l||[])).next())})},s=function(n,l){var t,e,o,u,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return u={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u;function r(u){return function(r){return function(u){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,e&&(o=2&u[0]?e.return:u[0]?e.throw||((o=e.return)&&o.call(e),0):e.next)&&!(o=o.call(e,u[1])).done)return o;switch(e=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return i.label++,{value:u[1],done:!1};case 5:i.label++,e=u[1],u=[0];continue;case 7:u=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===u[0]||2===u[0])){i=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){i.label=u[1];break}if(6===u[0]&&i.label<o[1]){i.label=o[1],o=u;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(u);break}o[2]&&i.ops.pop(),i.trys.pop();continue}u=l.call(n,i)}catch(r){u=[6,r],e=0}finally{t=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,r])}}},b=function(){function n(n,l,t,e,o,u,i,r,a,c,s){this.navCtrl=n,this.loadingCtrl=l,this.toastCtrl=t,this.camera=e,this.http=o,this.router=u,this.services=i,this.actionSheetCtrl=r,this.alertCtrl=a,this.modalCtrl=c,this.firebaseCordova=s,this.text=""}return n.prototype.ngOnInit=function(){this.getUser()},n.prototype.getUser=function(){var n=this;this.firebaseCordova.authState.subscribe(function(l){l?(console.log(l),console.log("authorized user"),n.userID=l.uid,n.photoUrl=l.photoURL,console.log(n.userID),n.getProfile(n.userID)):n.router.navigateByUrl("/login")},function(){n.router.navigateByUrl("/login")})},n.prototype.getProfile=function(n){return c(this,void 0,void 0,function(){var l=this;return s(this,function(t){return this.services.getProfile(n).subscribe(function(n){console.log(n),0===n.length?(l.empty=!1,console.log("empty")):(l.empty=!0,l.item=n)}),[2]})})},n.prototype.updateToken=function(n,l){r.firestore().collection("users").doc(l).set({token:n,tokenUpdate:r.firestore.FieldValue.serverTimestamp()},{merge:!0}).then(function(){console.log("token saved to cloud firestore")}).catch(function(n){console.log(n)})},n.prototype.dismissLoading=function(){return c(this,void 0,void 0,function(){return s(this,function(n){return this.loading&&this.loading.dismiss(),[2]})})},n.prototype.addPhoto=function(){this.launchCamera()},n.prototype.launchCamera=function(){var n=this;this.camera.getPicture({quality:100,sourceType:this.camera.PictureSourceType.CAMERA,destinationType:this.camera.DestinationType.DATA_URL,encodingType:this.camera.EncodingType.PNG,mediaType:this.camera.MediaType.PICTURE,correctOrientation:!0,targetHeight:512,targetWidth:512,allowEdit:!0}).then(function(l){console.log(l),n.image="data:image/png;base64,"+l}).catch(function(n){console.log(n)})},n.prototype.post=function(){var n=this;r.firestore().collection("posts").add({text:this.text,created:r.firestore.FieldValue.serverTimestamp(),owner:r.auth().currentUser.uid,owner_name:r.auth().currentUser.displayName,owner_photo:r.auth().currentUser.photoURL}).then(function(l){return c(n,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return console.log(l),this.image?[4,this.upload(l.id)]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.text="",this.image=void 0,[4,this.toastCtrl.create({message:"Your post has been created successfully.",duration:2e3})];case 3:return n.sent().present(),this.router.navigateByUrl("/tabs/feed"),[2]}})})}).catch(function(n){console.log(n)})},n.prototype.ago=function(n){var l=a(n).diff(a());return a.duration(l).humanize()},n.prototype.upload=function(n){var l=this;return new Promise(function(t,e){return c(l,void 0,void 0,function(){var l,o,u=this;return s(this,function(i){switch(i.label){case 0:return[4,this.loadingCtrl.create({message:"Uploading Image..."})];case 1:return i.sent().present(),l=r.storage().ref("postImages/"+n),(o=l.putString(this.image.split(",")[1],"base64")).on("state_changed",function(n){console.log(n),u.loadingCtrl.create({message:"Uploaded "+n.bytesTransferred/n.totalBytes*100+" % ..."})},function(n){console.log(n)},function(){console.log("The upload is complete!"),o.snapshot.ref.getDownloadURL().then(function(l){r.firestore().collection("posts").doc(n).update({image:l}).then(function(){u.dismissLoading(),t()}).catch(function(n){u.dismissLoading(),e()})}).catch(function(n){u.dismissLoading(),e()})}),[2]}})})})},n}(),p=function(){return function(){}}(),h=t("pMnS"),d=t("oBZk"),f=t("ZYCi"),g=t("Ip0R"),m=t("gIcY"),y=t("t/Na"),v=t("ZBkt"),k=e.ob({encapsulation:0,styles:[[""]],data:{}});function C(n){return e.Ib(0,[(n()(),e.qb(0,0,null,null,4,"ion-row",[["class","rowStyle"],["margin",""]],null,null,null,d.Q,d.m)),e.pb(1,49152,null,0,o.P,[e.h,e.k],null,null),(n()(),e.qb(2,0,null,0,2,"ion-card",[["class","round-corners"]],null,null,null,d.ab,d.w)),e.pb(3,49152,null,0,o.zb,[e.h,e.k],null,null),(n()(),e.qb(4,0,null,0,0,"img",[["class","round-corners"]],[[8,"src",4]],null,null,null,null))],null,function(n,l){n(l,4,0,l.component.image)})}function w(n){return e.Ib(0,[(n()(),e.qb(0,0,null,null,20,"ion-header",[],null,null,null,d.fb,d.B)),e.pb(1,49152,null,0,o.Ob,[e.h,e.k],null,null),(n()(),e.qb(2,0,null,0,18,"ion-toolbar",[],null,null,null,d.W,d.s)),e.pb(3,49152,null,0,o.hb,[e.h,e.k],null,null),(n()(),e.qb(4,0,null,0,3,"ion-buttons",[["slot","start"]],null,null,null,d.Z,d.v)),e.pb(5,49152,null,0,o.yb,[e.h,e.k],null,null),(n()(),e.qb(6,0,null,0,1,"ion-menu-button",[],null,null,null,d.M,d.i)),e.pb(7,49152,null,0,o.y,[e.h,e.k],null,null),(n()(),e.qb(8,0,null,0,2,"ion-title",[],null,null,null,d.U,d.q)),e.pb(9,49152,null,0,o.fb,[e.h,e.k],null,null),(n()(),e.Gb(-1,0,["Upload"])),(n()(),e.qb(11,0,null,0,9,"ion-buttons",[["slot","end"]],null,null,null,d.Z,d.v)),e.pb(12,49152,null,0,o.yb,[e.h,e.k],null,null),(n()(),e.qb(13,0,null,0,7,"ion-button",[],null,[[null,"click"]],function(n,l,t){var o=!0;return"click"===l&&(o=!1!==e.Ab(n,15).onClick()&&o),"click"===l&&(o=!1!==e.Ab(n,17).onClick(t)&&o),o},d.Y,d.u)),e.pb(14,49152,null,0,o.xb,[e.h,e.k],null,null),e.pb(15,16384,null,0,f.n,[f.m,f.a,[8,null],e.D,e.k],{routerLink:[0,"routerLink"]},null),e.Bb(16,1),e.pb(17,737280,null,0,o.rb,[g.i,o.mb,e.k,f.m,[2,f.n]],null,null),(n()(),e.Gb(-1,0,[" Back "])),(n()(),e.qb(19,0,null,0,1,"ion-icon",[["color","primary"],["mode","ios"],["name","arrow-back"],["slot","icon-only"]],null,null,null,d.gb,d.C)),e.pb(20,49152,null,0,o.Pb,[e.h,e.k],{color:[0,"color"],mode:[1,"mode"],name:[2,"name"]},null),(n()(),e.qb(21,0,null,null,18,"ion-content",[["fullscreen",""],["padding",""]],null,null,null,d.db,d.z)),e.pb(22,49152,null,0,o.Hb,[e.h,e.k],{fullscreen:[0,"fullscreen"]},null),(n()(),e.qb(23,0,null,0,14,"ion-row",[["class","rowStyle"],["margin",""]],null,null,null,d.Q,d.m)),e.pb(24,49152,null,0,o.P,[e.h,e.k],null,null),(n()(),e.qb(25,0,null,0,2,"button",[["clear",""],["color","primary"],["icon-only",""],["ion-button",""]],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.addPhoto()&&e),e},null,null)),(n()(),e.qb(26,0,null,null,1,"ion-icon",[["name","images"]],null,null,null,d.gb,d.C)),e.pb(27,49152,null,0,o.Pb,[e.h,e.k],{name:[0,"name"]},null),(n()(),e.qb(28,0,null,0,6,"ion-input",[["placeholder","Say something..."],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],function(n,l,t){var o=!0,u=n.component;return"ionBlur"===l&&(o=!1!==e.Ab(n,29)._handleBlurEvent()&&o),"ionChange"===l&&(o=!1!==e.Ab(n,29)._handleInputEvent(t.target.value)&&o),"ngModelChange"===l&&(o=!1!==(u.text=t)&&o),o},d.H,d.d)),e.pb(29,16384,null,0,o.pb,[e.k],null,null),e.Db(1024,null,m.c,function(n){return[n]},[o.pb]),e.pb(31,671744,null,0,m.f,[[8,null],[8,null],[8,null],[6,m.c]],{model:[0,"model"]},{update:"ngModelChange"}),e.Db(2048,null,m.d,null,[m.f]),e.pb(33,16384,null,0,m.e,[[4,m.d]],null,null),e.pb(34,49152,null,0,o.n,[e.h,e.k],{placeholder:[0,"placeholder"],type:[1,"type"]},null),(n()(),e.qb(35,0,null,0,2,"button",[["clear",""],["color","primary"],["icon-only",""],["ion-button",""]],null,[[null,"click"]],function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.post()&&e),e},null,null)),(n()(),e.qb(36,0,null,null,1,"ion-icon",[["name","send"]],null,null,null,d.gb,d.C)),e.pb(37,49152,null,0,o.Pb,[e.h,e.k],{name:[0,"name"]},null),(n()(),e.hb(16777216,null,0,1,null,C)),e.pb(39,16384,null,0,g.k,[e.P,e.L],{ngIf:[0,"ngIf"]},null)],function(n,l){var t=l.component,e=n(l,16,0,"/");n(l,15,0,e),n(l,17,0),n(l,20,0,"primary","ios","arrow-back"),n(l,22,0,""),n(l,27,0,"images"),n(l,31,0,t.text),n(l,34,0,"Say something...","text"),n(l,37,0,"send"),n(l,39,0,t.image)},function(n,l){n(l,28,0,e.Ab(l,33).ngClassUntouched,e.Ab(l,33).ngClassTouched,e.Ab(l,33).ngClassPristine,e.Ab(l,33).ngClassDirty,e.Ab(l,33).ngClassValid,e.Ab(l,33).ngClassInvalid,e.Ab(l,33).ngClassPending)})}function q(n){return e.Ib(0,[(n()(),e.qb(0,0,null,null,1,"app-tab2",[],null,null,null,w,k)),e.pb(1,114688,null,0,b,[o.g,o.e,o.j,u.a,y.c,f.m,i.a,o.a,o.b,o.f,v.a],null,null)],function(n,l){n(l,1,0)},null)}var P=e.mb("app-tab2",b,q,{},{},[]);t.d(l,"Tab2PageModuleNgFactory",function(){return U});var U=e.nb(p,[],function(n){return e.xb([e.yb(512,e.j,e.cb,[[8,[h.a,P]],[3,e.j],e.x]),e.yb(4608,g.m,g.l,[e.u,[2,g.s]]),e.yb(4608,m.i,m.i,[]),e.yb(4608,o.qb,o.qb,[e.z,e.g]),e.yb(4608,o.tb,o.tb,[o.qb,e.j,e.q]),e.yb(4608,o.ub,o.ub,[o.qb,e.j,e.q]),e.yb(1073742336,g.c,g.c,[]),e.yb(1073742336,m.h,m.h,[]),e.yb(1073742336,m.a,m.a,[]),e.yb(1073742336,o.c,o.c,[]),e.yb(1073742336,f.o,f.o,[[2,f.u],[2,f.m]]),e.yb(1073742336,p,p,[]),e.yb(1024,f.k,function(){return[[{path:"",component:b}]]},[])])})}}]);