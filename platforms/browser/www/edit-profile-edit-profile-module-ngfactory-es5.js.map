{"version":3,"sources":["webpack:///src/app/edit-profile/edit-profile.module.ts","webpack:///src/app/edit-profile/edit-profile.page.html","webpack:///src/app/edit-profile/edit-profile.page.ts"],"names":["routes","path","component","EditProfilePageModule","EditProfilePage","roouter","services","afs","loadingController","auth","getUser","authState","subscribe","user","mail","email","uid","console","log","getProfile","id","data","length","payload","doc","cp","name","phone","about","img","username","e","target","files","Math","random","toString","substring","file","filePath","ref","task","upload","uploadPercent","percentageChanges","presentLoading","snapshotChanges","pipe","urlImage","getDownloadURL","image","inputimageProd","nativeElement","value","createUser","then","res","navigateByUrl","updateUser","create","message","duration","loading","present","onDidDismiss","role","nextElement","setFocus"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;AAAA;;;AAAA;AAAA;AAAA;;AAMA,QAAMA,MAAM,GAAW,CACrB;AACEC,UAAI,EAAE,EADR;AAEEC,eAAS,EAAE;AAFb,KADqB,CAAvB;;QAgBaC,qB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;qECXP,sJ,IAA2D,I,EAAA;AAAA;;AAA7B;;AAA9B,sBAA8B,SAA9B;AAA2C,O;AAAA;;;qEAC3C,sJ,GAAsB,wL,GAAA,I,EAAA;AAAA;;AAAA,4JAAwB,SAAxB;;AAAtB,sBAAsB,SAAtB;AAA8C,O;AAAA;;;qEAI9C,sK,IAAmE,I,EAAA,I;AAAA;;;;;WAnBzE,qV,GAAA,8T,GACE,oV,GAAA,+T,GAEE,6T,GAAA,6T,GAAW,mF,IACX,mW,GAAA,+T,GACE;AAAA;AAAA,oBAAoE,UAApE;;AAAY;;;;;AAAZ;AAAA,wN,GAAA,+T,GAAoE,2E,IAK1E,uV,GAAA,gU,GACE,wI,IAEE,4I,IACE,iH,GAAA;AAAA;AAAA,c,GACA,iH,GAAA;AAAA;AAAA,c,GAEA,wH,IACA,wH,IACA,iH,GAAA;AAAA;AAAA,c,GAAoE,wH,IAItE,uL,IACE,oM,IACE;AAAA;AAAA,oBACgC,UADhC;;AACE;;;;;AADF;AAAA,oB,IAEA,8W,GAAA;AAAA;AAAA,c,GAAwD,gG,IAG5D,wH,IACA,6I,IAAqB,sF,IAErB,wH,IACA,+T,GAAA,6T,GACE;AAAA;AAAA;;AAAA;;;;;;;;;;AAAW;;;;;AAAuB;;;;;AAAlC;AAAA,sN,GAAA,0Q,EAAA;AAAA;AAAA,4E,EAAA;AAAA;AAAA;AAAA;AAAA,Q,EAAA,wL,EAAA,mN,EAAA;AAAA;AAAA,c,GACA,4V,GAAA;AAAA;AAAA,c,GAEF,wH,IACA,mV,GAAA,6T,GACE;AAAA;AAAA;;AAAA;;;;;;;;;;AAAW;;;;;AAA+D;;;;;AAA1E;AAAA,sN,GAAA,0Q,EAAA;AAAA;AAAA,4E,EAAA;AAAA;AAAA;AAAA;AAAA,Q,EAAA,wL,EAAA,mN,EAAA;AAAA;AAAA;AAAA,c,GAEF,mV,GAAA,6T,GACE;AAAA;AAAA;;AAAA;;;;;;;;;;AAAc;;;;;AAA6D;;;;;AAA3E;AAAA,sN,GAAA,0Q,EAAA;AAAA;AAAA,4E,EAAA;AAAA;AAAA;AAAA;AAAA,Q,EAAA,wL,EAAA,mN,EAAA;AAAA;AAAA;AAAA,c,GAGF,mV,GAAA,6T,GACE;AAAA;AAAA;;AAAA;;;;;;;;;;AAAW;;;;;AAAX;AAAA,sN,GAAA,0Q,EAAA;AAAA;AAAA,4E,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA,Q,EAAA,wL,EAAA,mN,EAAA;AAAA;AAAA,c,GAGF,mV,GAAA,6T,GACE;AAAA;AAAA;;AAAA;;;;;;;;;;AAAiB;;;;;AAAyE;;;;;AAA1F;AAAA,4N,GAAA,0Q,EAAA;AAAA;AAAA,4E,EAAA;AAAA;AAAA;AAAA;AAAA,Q,EAAA,wL,EAAA,mN,EAAA;AAAA;AAAA,c,GAMF,2M,GAAgC,wL,GAChC,wH,IAAI,wH,IAAI;AAAA;AA5CD,uCAAwB,SAAxB;;AAAL,uBAAK,SAAL;;AACK,2BAAgB,SAAhB;;AAAL,uBAAK,SAAL;;AAIK,6CAAyB,IAAzB;;AAAL,uBAAK,SAAL;;AAQyB;;AAAvB,uBAAuB,SAAvB;;AAQS,4BAAsB,SAAtB;;AAAX,uBAAW,UAAX;;AAA+D;;AAA/D,uBAA+D,UAA/D;;AACU;;AAAV,uBAAU,UAAV;;AAI0E,4BAAkB,KAAlB;;AAA1E,uBAA0E,UAA1E;;AAAuD;AAAf;;AAAxC,uBAAuD,UAAvD,EAAwC,UAAxC;;AAG2E,4BAAmB,MAAnB;;AAA3E,uBAA2E,UAA3E;;AAAuD;AAAZ;;AAA3C,uBAAuD,UAAvD,EAA2C,UAA3C;;AAI8B;AAAnB,4BAAkB,KAAlB;;AAAX,uBAA8B,UAA9B,EAAW,UAAX;;AAA8B;;AAA9B,uBAA8B,UAA9B;;AAI0F,4BAAoB,MAApB;;AAA1F,uBAA0F,UAA1F;;AAAsE;;AAAtE,uBAAsE,UAAtE;AAAyF,O,EAAA;AAAA;;AAhBzF;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAKA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAGA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAIA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAIA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAM8B,+JAA0B,SAA1B;;AAAhC,uBAAgC,UAAhC;AAA0D,O;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;QC3CjDC,e;;;AAgBX,+BAAoBC,OAApB,EACUC,QADV,EAEUC,GAFV,EAGUC,iBAHV,EAIUC,IAJV,EAIiC;AAAA;;AAJb,aAAAJ,OAAA,GAAAA,OAAA;AACV,aAAAC,QAAA,GAAAA,QAAA;AACA,aAAAC,GAAA,GAAAA,GAAA;AACA,aAAAC,iBAAA,GAAAA,iBAAA;AACA,aAAAC,IAAA,GAAAA,IAAA;AACT;;;;mCAEU;AACT,eAAKC,OAAL;AACD;;;kCAGS;AAAA;;AACR,eAAKD,IAAL,CAAUE,SAAV,CACGC,SADH,CAEI,UAAAC,IAAI,EAAI;AACN,gBAAIA,IAAJ,EAAU;AACR,mBAAI,CAACC,IAAL,GAAYD,IAAI,CAACE,KAAjB;AACA,mBAAI,CAACC,GAAL,GAAWH,IAAI,CAACG,GAAhB;AACAC,qBAAO,CAACC,GAAR,CAAY,KAAI,CAACJ,IAAjB;;AACA,mBAAI,CAACK,UAAL,CAAgB,KAAI,CAACH,GAArB;AACD;AACF,WATL;AAUD;;;mCAEgBI,E,EAAY;;;;;;;;;;AAC3B,yBAAKd,QAAL,CAAca,UAAd,CAAyBC,EAAzB,EAA6BR,SAA7B,CAAuC,UAACS,IAAD,EAAe;AACpDJ,6BAAO,CAACC,GAAR,CAAYG,IAAZ;;AACA,0BAAIA,IAAI,CAACC,MAAL,KAAgB,CAApB,EAAuB;AACrBL,+BAAO,CAACC,GAAR,CAAYG,IAAI,CAAC,CAAD,CAAJ,CAAQE,OAAR,CAAgBC,GAA5B;AACA,8BAAI,CAACC,EAAL,GAAU,IAAV;AACA,8BAAI,CAACL,EAAL,GAAUC,IAAI,CAAC,CAAD,CAAJ,CAAQE,OAAR,CAAgBC,GAAhB,CAAoBJ,EAA9B;AACA,8BAAI,CAACM,IAAL,GAAYL,IAAI,CAAC,CAAD,CAAJ,CAAQE,OAAR,CAAgBC,GAAhB,CAAoBH,IAApB,GAA2BK,IAAvC;AACA,8BAAI,CAACC,KAAL,GAAaN,IAAI,CAAC,CAAD,CAAJ,CAAQE,OAAR,CAAgBC,GAAhB,CAAoBH,IAApB,GAA2BM,KAAxC;AACA,8BAAI,CAACC,KAAL,GAAaP,IAAI,CAAC,CAAD,CAAJ,CAAQE,OAAR,CAAgBC,GAAhB,CAAoBH,IAApB,GAA2BO,KAAxC;AACA,8BAAI,CAACC,GAAL,GAAWR,IAAI,CAAC,CAAD,CAAJ,CAAQE,OAAR,CAAgBC,GAAhB,CAAoBH,IAApB,GAA2BQ,GAAtC;AACA,8BAAI,CAACC,QAAL,GAAgBT,IAAI,CAAC,CAAD,CAAJ,CAAQE,OAAR,CAAgBC,GAAhB,CAAoBH,IAApB,GAA2BS,QAA3C;AACAb,+BAAO,CAACC,GAAR,CAAY,cAAZ;AACD,uBAVD,MAUO;AACL,8BAAI,CAACO,EAAL,GAAU,KAAV;AACAR,+BAAO,CAACC,GAAR,CAAY,eAAZ;AACD;AACF,qBAhBD;;;;;;;;;AAiBD;;;iCAGQa,C,EAAmC;AAAA;;AAC1Cd,iBAAO,CAACC,GAAR,CAAYa,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAZ;AAEA,cAAMb,EAAE,GAAGc,IAAI,CAACC,MAAL,GAAcC,QAAd,CAAuB,EAAvB,EAA2BC,SAA3B,CAAqC,CAArC,CAAX;AACA,cAAMC,IAAI,GAAGP,CAAC,CAACC,MAAF,CAASC,KAAT,CAAe,CAAf,CAAb;AACA,cAAMM,QAAQ,uBAAgBnB,EAAhB,CAAd;AACA,cAAMoB,GAAG,GAAG,KAAKjC,GAAL,CAASiC,GAAT,CAAaD,QAAb,CAAZ;AACA,cAAME,IAAI,GAAG,KAAKlC,GAAL,CAASmC,MAAT,CAAgBH,QAAhB,EAA0BD,IAA1B,CAAb;AACA,eAAKK,aAAL,GAAqBF,IAAI,CAACG,iBAAL,EAArB;AACA,eAAKC,cAAL;AACAJ,cAAI,CAACK,eAAL,GAAuBC,IAAvB,CAA4B,gEAAS;AAAA,mBAAM,MAAI,CAACC,QAAL,GAAgBR,GAAG,CAACS,cAAJ,EAAtB;AAAA,WAAT,CAA5B,EAAkFrC,SAAlF;AACD;;;6BAGIc,I,EAAWC,K,EAAYC,K,EAAYE,Q,EAAgB;AAAA;;AACtDb,iBAAO,CAACC,GAAR,CAAY,KAAKO,EAAjB;AACA,cAAMyB,KAAK,GAAG,KAAKC,cAAL,CAAoBC,aAApB,CAAkCC,KAAhD;AACA,cAAMhC,IAAI,GAAG;AACXK,gBAAI,EAAEA,IADK;AAEXC,iBAAK,EAAEA,KAFI;AAGXb,gBAAI,EAAE,KAAKA,IAHA;AAIXe,eAAG,EAAEqB,KAAK,IAAI,KAAKrB,GAJR;AAKXD,iBAAK,EAAEA,KALI;AAMXZ,eAAG,EAAE,KAAKA,GANC;AAOXc,oBAAQ,EAAEA,QAAQ,IAAI;AAPX,WAAb;AASAb,iBAAO,CAACC,GAAR,CAAYG,IAAZ;;AACA,cAAI,KAAKI,EAAL,KAAY,KAAhB,EAAuB;AACrB,iBAAKnB,QAAL,CAAcgD,UAAd,CAAyBjC,IAAzB,EAA+BkC,IAA/B,CACE,UAAAC,GAAG,EAAI;AACLvC,qBAAO,CAACC,GAAR,CAAY,WAAWsC,GAAvB;;AACA,oBAAI,CAACnD,OAAL,CAAaoD,aAAb;AACD,aAJH;AAKD,WAND,MAMO;AACL,iBAAKnD,QAAL,CAAcoD,UAAd,CAAyBrC,IAAzB,EAA+B,KAAKD,EAApC,EAAwCmC,IAAxC,CACE,UAAAC,GAAG,EAAI;AACLvC,qBAAO,CAACC,GAAR,CAAY,WAAWsC,GAAvB;;AACA,oBAAI,CAACnD,OAAL,CAAaoD,aAAb;AACD,aAJH;AAKD;AAEF;;;yCAGsB;;;;;;;;;;;AACL,2BAAM,KAAKjD,iBAAL,CAAuBmD,MAAvB,CAA8B;AAClDC,6BAAO,EAAE,eADyC;AAElDC,8BAAQ,EAAE;AAFwC,qBAA9B,CAAN;;;AAAVC,2B;;AAIN,2BAAMA,OAAO,CAACC,OAAR,EAAN;;;;AAEuB,2BAAMD,OAAO,CAACE,YAAR,EAAN;;;;AAAfC,wB,yBAAAA,I;AAAM5C,wB,yBAAAA,I;AAEdJ,2BAAO,CAACC,GAAR,CAAY,oBAAZ;;;;;;;;;AACD;;;kCACSgD,W,EAAwC;AAChDA,qBAAW,CAACC,QAAZ;AACD","file":"edit-profile-edit-profile-module-ngfactory-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { EditProfilePage } from './edit-profile.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: EditProfilePage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [EditProfilePage]\n})\nexport class EditProfilePageModule {}\n","<ion-header no-border>\n  <ion-toolbar no-border>\n\n    <ion-title>Edit Profile</ion-title>\n    <ion-buttons slot=\"end\" padding>\n      <ion-button (click)=\"save(name, phone, about, username)\" slot=\"end\">Save</ion-button>\n    </ion-buttons>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content padding>\n  <div class=\"form\">\n\n    <div text-center>\n      <img *ngIf=\"img && !urlImage\" src=\"{{img}}\" class=\"circle\">\n      <img *ngIf=\"urlImage\" [src]=\"urlImage | async\" class=\"circle\">\n\n      <br>\n      <br>\n      <img *ngIf=\"!urlImage && !img\" src=\"assets/user.svg\" width=\"200px\"> <br>\n    </div>\n\n\n    <div margin-bottom margin-top text-center>\n      <label class=\"custom-file-upload\" style=\"margin:auto;max-width:400px\">\n        <input id=\"file-upload\" placeholder=\"Seleciona imagen\" type=\"file\" accept=\".png, .jpg\"\n          (change)=\"onUpload($event)\" />\n        <ion-icon margin-right name=\"cloud-download\"></ion-icon> Select profile photo\n      </label>\n    </div>                                                                                                                                                                                  \n    <br>\n    <h3 class=\"goodfont\">Profile info</h3>\n\n    <br>\n    <ion-item>\n      <ion-input [(ngModel)]=\"username\" (keyup.enter)=\"moveFocus(b)\" placeholder=\"username\"></ion-input>\n      <ion-icon name=\"at\" slot=\"start\"></ion-icon>\n    </ion-item>\n    <br>\n    <ion-item margin-bottom margin-bottom>\n      <ion-input (keyup.enter)=\"moveFocus(c)\" type=\"text\" #b placeholder=\"Name\" [(ngModel)]=\"name\"></ion-input>\n    </ion-item>\n    <ion-item margin-bottom margin-bottom>\n      <ion-input #c (keyup.enter)=\"moveFocus(d)\" type=\"text\" placeholder=\"Phone\" [(ngModel)]=\"phone\"></ion-input>\n    </ion-item>\n\n    <ion-item margin-bottom margin-bottom>\n      <ion-input [(ngModel)]=\"mail\" disabled></ion-input>\n    </ion-item>\n\n    <ion-item margin-bottom margin-bottom>\n      <ion-textarea #d (keyup.enter)=\"save(name, phone, about)\" type=\"text\" placeholder=\"About\" [(ngModel)]=\" about\">\n      </ion-textarea>\n    </ion-item>\n\n\n\n    <input #imageProd type=\"hidden\" [value]=\"urlImage | async\" style=\"color:black;\">\n    <br><br>\n    <!-- <ion-button mode=\"ios\" size=\"large\" class=\"main-container\" color=\"light\" expand=\"block\">\n    Save</ion-button> -->\n  </div>\n</ion-content>","import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { ServicesService } from '../services/services.service';\nimport { Observable } from 'rxjs';\nimport { LoadingController } from '@ionic/angular';\nimport { Router } from '@angular/router';\nimport { AngularFireStorage } from '@angular/fire/storage';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { finalize } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-edit-profile',\n  templateUrl: './edit-profile.page.html',\n  styleUrls: ['./edit-profile.page.scss'],\n})\nexport class EditProfilePage implements OnInit {\n  @ViewChild('imageProd', { static: true }) inputimageProd: ElementRef;\n  id: any;\n  uid: string;\n  name: any;\n  phone: string;\n  about: string;\n  img: any;\n  mail: string;\n  uploadPercent: Observable<number>;\n  urlImage: Observable<string>;\n  item: any;\n  username: string;\n\n  cp: Boolean;\n\n  constructor(private roouter: Router,\n    private services: ServicesService,\n    private afs: AngularFireStorage,\n    private loadingController: LoadingController,\n    private auth: AngularFireAuth) {\n  }\n\n  ngOnInit() {\n    this.getUser();\n  }\n\n\n  getUser() {\n    this.auth.authState\n      .subscribe(\n        user => {\n          if (user) {\n            this.mail = user.email;\n            this.uid = user.uid;\n            console.log(this.mail);\n            this.getProfile(this.uid);\n          }\n        });\n  }\n\n  async getProfile(id: string) {\n    this.services.getProfile(id).subscribe((data: any) => {\n      console.log(data);\n      if (data.length !== 0) {\n        console.log(data[0].payload.doc);\n        this.cp = true;\n        this.id = data[0].payload.doc.id;\n        this.name = data[0].payload.doc.data().name;\n        this.phone = data[0].payload.doc.data().phone;\n        this.about = data[0].payload.doc.data().about;\n        this.img = data[0].payload.doc.data().img;\n        this.username = data[0].payload.doc.data().username;\n        console.log('profile full');\n      } else {\n        this.cp = false;\n        console.log('profile empty');\n      }\n    });\n  }\n\n\n  onUpload(e: { target: { files: any[]; }; }) {\n    console.log(e.target.files[0]);\n\n    const id = Math.random().toString(36).substring(2);\n    const file = e.target.files[0];\n    const filePath = `image/pic_${id}`;\n    const ref = this.afs.ref(filePath);\n    const task = this.afs.upload(filePath, file);\n    this.uploadPercent = task.percentageChanges();\n    this.presentLoading();\n    task.snapshotChanges().pipe(finalize(() => this.urlImage = ref.getDownloadURL())).subscribe();\n  }\n\n\n  save(name: any, phone: any, about: any, username?: any) {\n    console.log(this.cp);\n    const image = this.inputimageProd.nativeElement.value;\n    const data = {\n      name: name,\n      phone: phone,\n      mail: this.mail,\n      img: image || this.img,\n      about: about,\n      uid: this.uid,\n      username: username || 'null'\n    };\n    console.log(data);\n    if (this.cp === false) {\n      this.services.createUser(data).then(\n        res => {\n          console.log('Upload' + res);\n          this.roouter.navigateByUrl(`/profile`);\n        });\n    } else {\n      this.services.updateUser(data, this.id).then(\n        res => {\n          console.log('Upload' + res);\n          this.roouter.navigateByUrl(`/profile`);\n        });\n    }\n\n  }\n\n\n  async presentLoading() {\n    const loading = await this.loadingController.create({\n      message: 'Loading image',\n      duration: 2000\n    });\n    await loading.present();\n\n    const { role, data } = await loading.onDidDismiss();\n\n    console.log('Loading dismissed!');\n  }\n  moveFocus(nextElement: { setFocus: () => void; }) {\n    nextElement.setFocus();\n  }\n\n}\n"]}